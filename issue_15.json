{"body":"## Priority\nHIGH (Security hardening)\n\n## Use Case\nReduce kernel attack surface by blocking dangerous system calls.\n\n## Current State\nisol8 uses:\n- ✅ `no-new-privileges`\n- ✅ `ReadonlyRootfs`\n- ✅ Non-root user\n- ❌ No seccomp filter\n- ❌ No AppArmor/SELinux\n\n## Proposed Implementation\nCreate `docker/seccomp-profile.json`:\n```json\n{\n  \"defaultAction\": \"SCMP_ACT_ERRNO\",\n  \"architectures\": [\"SCMP_ARCH_X86_64\", \"SCMP_ARCH_AARCH64\"],\n  \"syscalls\": [\n    {\n      \"names\": [\n        \"read\", \"write\", \"open\", \"close\", \"stat\",\n        \"fstat\", \"lstat\", \"poll\", \"lseek\", \"mmap\",\n        \"mprotect\", \"munmap\", \"brk\", \"rt_sigaction\",\n        \"rt_sigprocmask\", \"rt_sigreturn\", \"ioctl\",\n        \"pread64\", \"pwrite64\", \"readv\", \"writev\",\n        \"access\", \"pipe\", \"select\", \"sched_yield\",\n        \"mremap\", \"msync\", \"mincore\", \"madvise\"\n      ],\n      \"action\": \"SCMP_ACT_ALLOW\"\n    },\n    {\n      \"names\": [\n        \"mount\", \"umount2\", \"pivot_root\", \"chroot\",\n        \"ptrace\", \"process_vm_readv\", \"process_vm_writev\",\n        \"kexec_load\", \"kexec_file_load\", \"bpf\",\n        \"perf_event_open\", \"fanotify_init\"\n      ],\n      \"action\": \"SCMP_ACT_ERRNO\"\n    }\n  ]\n}\n```\n\nApply in HostConfig:\n```typescript\nHostConfig: {\n  SecurityOpt: [\n    \"no-new-privileges\",\n    \"seccomp=/path/to/seccomp-profile.json\"\n  ]\n}\n```\n\n## Blocked Syscalls (Dangerous)\n- `mount`, `umount` - Filesystem manipulation\n- `ptrace` - Process inspection/injection\n- `kexec_load` - Kernel replacement\n- `bpf` - eBPF programs\n- `perf_event_open` - Performance monitoring (side channels)\n- `process_vm_readv` - Memory dumping\n\n## Benefits\n- Prevent container escape exploits (DirtyPipe, etc.)\n- Block kernel vulnerability exploitation\n- Reduce attack surface by 90%+\n- Compliance with CIS Docker Benchmark\n\n## Configuration\n```json\n{\n  \"security\": {\n    \"seccomp\": \"strict\",  // strict, moderate, permissive, disabled\n    \"customProfile\": \"/path/to/custom-seccomp.json\"\n  }\n}\n```\n\n## Testing\n```bash\n# Verify seccomp is applied\ndocker inspect <container> | jq '.[0].HostConfig.SecurityOpt'\n\n# Test blocked syscall\nisol8 run -e \"import os; os.mount()\" --runtime python\n# Should fail with EPERM\n```\n\n## References\n- [Docker seccomp profiles](https://docs.docker.com/engine/security/seccomp/)\n- [CIS Docker Benchmark 5.21](https://www.cisecurity.org/benchmark/docker)\n","title":"[FEATURE] Add seccomp profile for syscall filtering"}
